<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Screen</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1324815029</timestamp>
		<class>dataenvironment</class>
		<classloc/>
		<baseclass>dataenvironment</baseclass>
		<objname>Dataenvironment</objname>
		<parent/>
		<properties>Top = 220
Left = 1
Width = 765
Height = 493
DataSource = .NULL.
Name = "Dataenvironment"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2>3</reserved2>
		<reserved3/>
		<reserved4>2</reserved4>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IY0V5R68</uniqueid>
		<timestamp>1325553490</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor1</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 20
Left = 10
Height = 90
Width = 90
Alias = "mr_instances1"
Database = ..\data\data1.dbc
CursorSource = "mr_instances"
Name = "Cursor1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IY0V8FA6</uniqueid>
		<timestamp>1325553490</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor2</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 20
Left = 150
Height = 90
Width = 90
Alias = "mr_instances"
Database = ..\data\data1.dbc
CursorSource = "mr_instances"
Name = "Cursor2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5H3</uniqueid>
		<timestamp>1325553490</timestamp>
		<class>_form</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>mr_mods_jij</objname>
		<parent/>
		<properties>Top = 0
Left = 0
DoCreate = .T.
Caption = "JIJ"
uniqueid = 27BA27FF71AE410DB1203389AA8F7135
Name = "MR_MODS_JIJ"
tmrSql.Name = "tmrSql"
</properties>
		<protected/>
		<methods>PROCEDURE Destroy
*!* destroy


ENDPROC
PROCEDURE init2
*!* init2

m.iguid = _inigetvalue('MR_INSTANCES_IGUID', '00000000')

Thisform.mr_setinstance(m.iguid)

Thisform.updateui()
ENDPROC
PROCEDURE load2
Select * From 'mr_jijs' Into Cursor 'sql_jijs1' Readwrite

Use Dbf('sql_jijs1') Again In 0 Alias 'sql_jijs'
ENDPROC
PROCEDURE mr_filescan
Lparameters pfilename, pfiledata, plevel

Local filedata, json, lnx, ojson

m.json = mr_getfilefromzipdata(m.pfiledata, 'fabric.mod.json')

If Not Empty(m.json)

m.ojson = nfjsonread(m.json)

Append Blank In 'sql_jijs1'

Replace sql_jijs1.filename With m.pfilename In 'sql_jijs1'

*If m.plevel &gt; 0 Then

Replace sql_jijs1.jij With Justfname(m.pfilename) In 'sql_jijs1'

*Endif

Replace sql_jijs1.jijlevel With m.plevel In 'sql_jijs1'

If '"requires"' $ m.json

Replace sql_jijs1.requires With 1 In 'sql_jijs1'

Endif

If Type('m.ojson.environment') = 'C'

Replace sql_jijs1.jenv With 'environment=' + m.ojson.environment In 'sql_jijs1'

Endif

If Type('m.ojson.side') = 'C'

Replace sql_jijs1.jenv With 'side=' + m.ojson.side In 'sql_jijs1'

Endif


If Type('m.ojson.id') = 'C'

Replace sql_jijs1.modid With m.ojson.Id In 'sql_jijs1'

Endif

Replace sql_jijs1.json With m.json In 'sql_jijs1'

Replace sql_jijs1.jijsize With Len(m.pfiledata) In 'sql_jijs1'

If Type('m.ojson.jars[1].file') = 'C'

For m.lnx = 1 To Alen(m.ojson.jars)

m.filedata =  mr_getfilefromzipdata(m.pfiledata, m.ojson.jars[m.lnx].File)

Thisform.mr_filescan(m.pfilename + '/' + Justfname(m.ojson.jars[m.lnx].File), m.filedata, m.plevel + 1)

Endfor

Endif

Endif
ENDPROC
PROCEDURE mr_folderscan
Local afiles[1], filename, filespec, fileunc, ifolder, lnx, ncount

_logwrite('SCAN START')

*!* SCAN FOLDER FOR FILES

m.ifolder = mr_instances.ifolder

m.filespec = Addbs(m.ifolder) + '*.jar'

m.ncount = Adir(afiles, m.filespec, '', 1)

For m.lnx = 1 To m.ncount

m.filename	= m.afiles(m.lnx, 1)

If Not Inlist(Upper(Justext(m.filename)), 'JAR', 'DISABLED')

Loop

Endif

m.fileunc = Addbs(m.ifolder) + m.filename

_logwrite(m.fileunc)

Thisform.mr_filescan(m.filename, Filetostr(m.fileunc), 0)

Endfor

_logwrite('SCAN END')



ENDPROC
PROCEDURE mr_setinstance
*!* mr_setinstance

Lparameters piguid

If m.piguid = '00000000' And Reccount('mr_instances') &gt; 0 Then

Go Top In 'mr_instances'

Endif

If Seek(m.piguid, 'mr_instances', 'iguid') = .T.

_inisetvalue('MR_INSTANCES_IGUID', mr_instances.iguid)

If Empty(mr_instances.iname) Then

Thisform.Caption = 'JIJ - ' + _shortenpath(mr_instances.iguid, 240)

Else

Thisform.Caption = 'JIJ - ' + _shortenpath(mr_instances.iname, 240)

Endif


Else

Thisform.SetAll('ENABLED', .F.)

Thisform.tbinstances.Enabled = .T.

Thisform.Caption = 'JIJ - NO INSTANCE SELECTED'


Endif

Delete All In 'sql_jijs'

Thisform.updateui()

Thisform.Refresh()
ENDPROC
PROCEDURE updateui
*!* updateui

Local icaption, sep


m.sep = Space(3)

m.icaption = ' ' + ;
'GUID: ' + mr_instances.iguid + m.sep + ;
'NAME: ' + mr_instances.iname + m.sep + ;
'VERSION ' + mr_instances.iminecraft + m.sep + ;
'LOADER: ' + mr_instances.iloader + m.sep + ;
'MINVER: ' + mr_instances.gver1 + m.sep + ;
'MAXVER: ' + mr_instances.gver2 + m.sep + ;
'PATH: '

m.icaption = m.icaption + _shortenpath(mr_instances.ifolder, 255 - Len(m.icaption))

Thisform.lblinstance.Caption = m.icaption



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3>*mr_setinstance 
*mr_folderscan 
*mr_filescan 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I6106W9K</uniqueid>
		<timestamp>1323865558</timestamp>
		<class>_editbox</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtlog</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>FontName = "Consolas"
FontSize = 8
Anchor = 14
Height = 144
Left = 12
ReadOnly = .T.
TabIndex = 9
Top = 324
Width = 936
ZOrderSet = 0
Value = 
IntegralHeight = .F.
islog = .T.
Name = "edtlog"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5H4</uniqueid>
		<timestamp>1323895511</timestamp>
		<class>_gridview</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>gridmain</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Height = 276
Left = 12
RecordSource = "sql_jijs"
Top = 36
Width = 936
_gridcontextmenulang = en
Name = "gridmain"
</properties>
		<protected/>
		<methods>PROCEDURE AfterRowColChange
LPARAMETERS nColIndex

Thisform.updateui()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IY0VMAZ0</uniqueid>
		<timestamp>1324726966</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbscan</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Top = 0
Left = 132
Height = 28
Width = 84
Picture = ..\res\1x\outline_autorenew_black_18dp.png
Caption = "SCAN"
ToolTipText = "SCAN MODS FOLDER"
ZOrderSet = 4
tbstyle = 7
Name = "tbscan"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_logwrite('PROCESS START')

Delete All In 'sql_jijs'

Thisform.mr_folderscan()

_logwrite('PROCESS END')

Go Top In 'sql_jijs'

Thisform.updateui()

Thisform.Refresh()




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IY0V5R6M</uniqueid>
		<timestamp>1323865110</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbinstances</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Top = 0
Left = 12
Height = 28
Width = 108
Picture = ..\res\1x\outline_expand_more_black_18dp.png
Caption = "INSTANCES"
ToolTipText = "OPEN INSTANCES MENU"
PicturePosition = 4
ZOrderSet = 4
tbmarginv = 4
tbstyle = 7
Name = "tbinstances"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local nselect, result

m.nselect = Select()

Select 'mr_instances1'

Scan

This.tbmenuitemadd(Recno('mr_instances1'), 0, 0, 0, 0, mr_instances1.iname + ' - ' + mr_instances1.ifolder)

Endscan

_restorearea(m.nselect)

m.result = This.tbmenushow()

If m.result &gt; 0 Then

Go m.result In 'mr_instances1'

Thisform.mr_setinstance(mr_instances1.iguid)

Endif





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1324746072</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbjson</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Top = 0
Left = 228
Height = 28
Width = 132
Picture = ..\res\1x\outline_description_black_18dp.png
Caption = "fabric.mod.json"
ToolTipText = "OPEN JSON IN NOTEPAD"
ZOrderSet = 4
tbmarginv = 4
Name = "tbjson"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local cfile

m.cfile = _getapppath() + 'json'

If Not Directory(m.cfile, 1)

Mkdir(m.cfile)

Endif

If Not Empty(sql_jijs.modid)

m.cfile = m.cfile + '\j_' + sql_jijs.modid + '.txt'

Endif

Strtofile(sql_jijs.json, m.cfile)

mr_shellexecute(m.cfile)





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5JB1EWWS4</uniqueid>
		<timestamp>1324815822</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>_tbcommand1</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Top = 0
Left = 372
Height = 28
Width = 84
Picture = ..\res\1x\outline_description_black_18dp.png
Caption = "LIST TO CLIPBOARD"
ToolTipText = "OPEN JSON IN NOTEPAD"
ZOrderSet = 4
tbmarginv = 4
Name = "_tbcommand1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local txt

Select sql_jijs

Calculate Max(Len(sql_jijs.filename)) To m.padfilename
Calculate Max(Len(sql_jijs.jij)) To m.padjij
Calculate Max(Len(sql_jijs.modid )) To m.padmodid


m.txt = ''

Scan

m.txt = m.txt + Padr(sql_jijs.filename, m.padfilename, ' ') + ','

m.txt = m.txt + Padr(sql_jijs.jij, m.padjij, ' ') + ','

m.txt = m.txt + Transform(sql_jijs.jijlevel) + ','

m.txt = m.txt + sql_jijs.modid + 0h0d0a

Endscan

_Cliptext = m.txt


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1322123709</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbmenu</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>Top = 0
Left = 924
Height = 28
Width = 28
FontSize = 8
Picture = ..\res\3bars.png
Caption = ""
TabIndex = 7
ToolTipText = "MENU"
ZOrderSet = 21
tbalign = 2
tbautowidth = .F.
tbpictureautosize = .F.
tbmenuoffseth = 6
tbautofontsize = .F.
tbmarginv = 4
Name = "tbmenu"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IY148ZB7</uniqueid>
		<timestamp>1323865558</timestamp>
		<class>_label</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblinstance</objname>
		<parent>MR_MODS_JIJ</parent>
		<properties>FontSize = 8
Anchor = 14
Caption = ""
Height = 15
Left = 12
Top = 480
Width = 936
autowidth = .F.
Name = "lblinstance"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties>Tahoma, 0, 8, 5, 13, 11, 27, 2, 0
Consolas, 0, 8, 6, 13, 10, 12, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Segoe UI, 0, 8, 6, 13, 11, 28, 2, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
