<?xml version = "1.0" encoding="UTF-8" standalone="yes"?>
<VFPData>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>Screen</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties/>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1>VERSION =   3.00</reserved1>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1327327404</timestamp>
		<class>dataenvironment</class>
		<classloc/>
		<baseclass>dataenvironment</baseclass>
		<objname>Dataenvironment</objname>
		<parent/>
		<properties>Top = 259
Left = -235
Width = 1570
Height = 663
DataSource = .NULL.
Name = "Dataenvironment"
</properties>
		<protected/>
		<methods>PROCEDURE AfterCloseTables
Close Tables All
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2>10</reserved2>
		<reserved3/>
		<reserved4>2</reserved4>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I50Z6RB2</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor1</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 13
Left = 17
Height = 407
Width = 127
Alias = "mr_mods"
Order = "filename1"
Database = ..\data\data1.dbc
CursorSource = "mr_mods"
Name = "Cursor1"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I61EBSMR</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor2</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 15
Left = 179
Height = 362
Width = 106
Alias = "mr_instances"
Database = ..\data\data1.dbc
CursorSource = "mr_instances"
Name = "Cursor2"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I70HWZP6</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor3</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 18
Left = 319
Height = 351
Width = 112
Alias = "mr_mods1"
Order = ""
Database = ..\data\data1.dbc
CursorSource = "mr_mods"
Name = "Cursor3"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I70J9KXM</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor4</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 11
Left = 481
Height = 357
Width = 101
Alias = "mr_files"
Database = ..\data\data1.dbc
CursorSource = "mr_files"
Name = "Cursor4"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I80FSB4G</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor7</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 318
Left = 774
Height = 90
Width = 173
Alias = "mr_enum_gameversion"
Order = "gverlong"
OrderDirection = 2
Database = ..\data\data1.dbc
CursorSource = "mr_enum_gameversion"
Name = "Cursor7"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IA0IPOO1</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor8</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 322
Left = 617
Height = 162
Width = 107
Alias = "mr_instances1"
Order = "iname"
Database = ..\data\data1.dbc
CursorSource = "mr_instances"
Name = "Cursor8"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5ID0K0IKM</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor9</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 15
Left = 610
Height = 90
Width = 90
Alias = "mr_log"
Database = ..\data\data1.dbc
CursorSource = "mr_log"
Name = "Cursor9"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IG12MLGC</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor11</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 21
Left = 735
Height = 234
Width = 117
Alias = "mr_addons"
Database = ..\data\data1.dbc
CursorSource = "mr_addons"
Name = "Cursor11"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5JT058YZE</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>cursor</class>
		<classloc/>
		<baseclass>cursor</baseclass>
		<objname>Cursor10</objname>
		<parent>Dataenvironment</parent>
		<properties>Top = 294
Left = 987
Height = 90
Width = 90
Alias = "mr_modids"
Database = ..\data\data1.dbc
CursorSource = "mr_modids"
Name = "Cursor10"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5H3</uniqueid>
		<timestamp>1327456403</timestamp>
		<class>_form</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>form</baseclass>
		<objname>mr_mods</objname>
		<parent/>
		<properties>Top = 0
Left = 0
DoCreate = .T.
Caption = "MODS"
gridrowcolor = 0
mr_loader = 
mr_iguid = 
uniqueid = D74C4473368A4B07ADDB19F79B139BE9
Name = "MR_MODS"
tmrSql.Name = "tmrSql"
</properties>
		<protected/>
		<methods>PROCEDURE init2
*!* init2

Local iguid

m.iguid = _inigetvalue('MR_INSTANCES_IGUID', '00000000')

Thisform.mr_setinstance(m.iguid)




ENDPROC
PROCEDURE mr_disableall
*!* mr_disableall

Local filenamen, filenameo, result

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid And Upper(Justext(mr_mods1.filename1)) = 'JAR'

m.filenameo = mr_mods1.filename1

m.filenamen = mr_mods1.filename1 + '.disabled'

m.result = _apimovefile(Addbs(mr_instances.ifolder) + m.filenameo, Addbs(mr_instances.ifolder) + m.filenamen)

If m.result # 0

Replace mr_log.iguid With mr_mods1.iguid In 'mr_log'
Replace mr_log.ifolder With mr_instances.ifolder In 'mr_log'
Replace mr_log.fid1 With mr_mods1.fid1 In 'mr_log'
Replace mr_log.filename1 With m.filenameo In 'mr_log'
Replace mr_log.filename2 With m.filenamen In 'mr_log'
Replace mr_log.hash1 With mr_mods1.hash1 In 'mr_log'
Replace mr_log.ldesc With 'DISABLED' In 'mr_log'
Replace mr_log.ldatetime With DATETIME() In 'mr_log'

Replace mr_mods1.filename1 With m.filenamen In 'mr_mods1'
Replace mr_mods1.dis With .T. In 'mr_mods1'

Endif

Endscan

Thisform.gridmain.Refresh()


ENDPROC
PROCEDURE mr_enableall
*!* mr_enableall

Local filenamen, filenameo, result

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid And Upper(Justext(mr_mods1.filename1)) = 'DISABLED'

m.filenameo = mr_mods1.filename1

m.filenamen = Juststem(Juststem(mr_mods1.filename1)) + '.jar'

m.result = _apimovefile(Addbs(mr_instances.ifolder) + m.filenameo, Addbs(mr_instances.ifolder) + m.filenamen)

If m.result # 0

Append Blank In mr_log

Replace mr_log.iguid With mr_mods1.iguid In 'mr_log'
Replace mr_log.ifolder With mr_instances.ifolder In 'mr_log'
Replace mr_log.fid1 With mr_mods1.fid1 In 'mr_log'
Replace mr_log.filename1 With m.filenameo In 'mr_log'
Replace mr_log.filename2 With m.filenamen In 'mr_log'
Replace mr_log.hash1 With mr_mods1.hash1 In 'mr_log'
Replace mr_log.ldesc With 'ENABLED' In 'mr_log'
Replace mr_log.ldatetime With DATETIME() In 'mr_log'

Replace mr_mods1.filename1 With m.filenamen In 'mr_mods1'
Replace mr_mods1.dis With .F. In 'mr_mods1'

Endif

Endscan

Thisform.gridmain.Refresh()


ENDPROC
PROCEDURE mr_getcursedata
*!* mr_getcursedata


if seek(mr_mods1.hash1, 'mr_files', 'hash') = .t.

	_logwrite('UPDATE FILE DATA', mr_files.aid)

	replace mr_mods1.aid with mr_files.aid in 'mr_mods1'
	replace mr_mods1.fid1 with mr_files.fid in 'mr_mods1'
	replace mr_mods1.aname with mr_files.aname in 'mr_mods1'
	replace mr_mods1.authorname with mr_files.authorname in 'mr_mods1'
	replace mr_mods1.gver1 with mr_files.gver in 'mr_mods1'
	replace mr_mods1.rtypename1 with mr_files.rtypename in 'mr_mods1'
	replace mr_mods1.filedate1 with mr_files.filedate in 'mr_mods1'
	replace mr_mods1.loader1 with mr_files.foldername in 'mr_mods1'

	*!* SAVE LOADER TO BE USED WHEN SEARCHING FOR NEW FILES

	if not empty(mr_files.foldername)

		thisform.mr_loader = mr_files.foldername

	endif

endif






ENDPROC
PROCEDURE mr_getcursedatascan
*!* mr_getcursedatascan

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid

DoEvents

Thisform.mr_getcursedata()

Endscan




ENDPROC
PROCEDURE mr_getfolderdatascan
*!* mr_getfolderdatascan

local afiles[1], fguid, filelen1, filename1, filespec, fileunc, hash1, ifolder, iguid, lnx, ncount
local omod, omodprops, rguid

if empty(thisform.mr_iguid)

	_logwrite('NO INSTANCE SELECTED')

	return

endif

_logwrite('SCAN START')

m.iguid = thisform.mr_iguid

select 'mr_mods1'

scatter blank name m.omod

m.omod.iguid = '00000000'
m.omod.fguid = '00000000'
m.omod.rguid = '0000000000000000'

*!* FIRST SCAN EXISTING RECORDS TO CHECK FOR MISSING FILES

scan for mr_mods1.iguid == m.iguid

	m.fileunc = addbs(mr_instances.ifolder) + mr_mods1.filename1

	_logwrite('CHECK', justfname(m.fileunc))

	m.hash1 = mr_fingerprint(m.fileunc)

	if mr_mods1.hash1 # m.hash1 then

		append blank in mr_log

		replace mr_log.iguid with m.iguid in 'mr_log'
		replace mr_log.ifolder with mr_instances.ifolder in 'mr_log'
		replace mr_log.fid1 with mr_mods1.fid1 in 'mr_log'
		replace mr_log.filename1 with mr_mods1.filename1 in 'mr_log'
		replace mr_log.hash1 with mr_mods1.hash1 in 'mr_log'

		if m.hash1 = 0

			replace mr_log.ldesc with 'DELETED' in 'mr_log'

		else

			replace mr_log.ldesc with 'HASH CHANGED' in 'mr_log'
			replace mr_log.hash2 with m.hash1 in 'mr_log'

		endif

		replace mr_log.ldatetime with datetime() in 'mr_log'

		*!* BLANK MR_MODS RECORD FOR LATER REUSE

		gather name m.omod

	endif

endscan

*!* SCAN FOLDER FOR FILES

m.ifolder = mr_instances.ifolder

m.filespec = addbs(m.ifolder) + '*.*'

m.ncount = adir(afiles, m.filespec, '', 1)

for m.lnx = 1 to m.ncount

	m.filename1	= m.afiles(m.lnx, 1)

	if not inlist(upper(justext(m.filename1)), 'JAR', 'DISABLED')

		loop

	endif

	m.fileunc = addbs(m.ifolder) + m.filename1

	_logwrite('SCAN', justfname(m.fileunc))

	m.filelen1 = m.afiles(m.lnx, 2)

	m.hash1 = mr_fingerprint(m.fileunc)

	m.fguid = strconv(_ubintoc(m.hash1), 15)

	m.rguid = m.iguid + m.fguid

	m.omodprops = mr_getmodproperties(m.fileunc)

	*!* IF THERE IS NO RECORD FOR THE FILE, REUSE BLANK RECORD OR APPEND NEW

	if seek(m.rguid, 'mr_mods1', 'rguid') = .f.

		if seek('00000000', 'mr_mods1', 'IGUID') = .f.

			append blank in 'mr_mods1'

		endif

		replace mr_mods1.rguid with m.rguid in 'mr_mods1'
		replace mr_mods1.upd with .t. in 'mr_mods1'


		*!* NEW FILE ADD TO LOG

		append blank in mr_log

		replace mr_log.ifolder with mr_instances.ifolder in 'mr_log'
		replace mr_log.fid1 with mr_mods1.fid1 in 'mr_log'
		replace mr_log.filename1 with m.filename1 in 'mr_log'
		replace mr_log.ldesc with 'NEW' in 'mr_log'
		replace mr_log.ldatetime with datetime() in 'mr_log'
		replace mr_log.hash1 with m.hash1 in 'mr_mods1'

	endif

	replace mr_mods1.iguid with m.iguid in 'mr_mods1'
	replace mr_mods1.fguid with m.fguid in 'mr_mods1'
	replace mr_mods1.filename1 with m.filename1 in 'mr_mods1'
	replace mr_mods1.filelen1 with m.filelen1 in 'mr_mods1'
	replace mr_mods1.hash1 with m.hash1 in 'mr_mods1'
	replace mr_mods1.modid with m.omodprops.mod_id in 'mr_mods1'
	replace mr_mods1.aname with m.omodprops.mod_name in 'mr_mods1'
	replace mr_mods1.authorname with m.omodprops.mod_authors in 'mr_mods1'
	replace mr_mods1.env with m.omodprops.mod_environment in 'mr_mods1'

	if upper(justext(mr_mods1.filename1)) = 'JAR'

		replace mr_mods1.dis with .f. in 'mr_mods1'

	endif

	if upper(justext(mr_mods1.filename1)) = 'DISABLED'

		replace mr_mods1.dis with .t. in 'mr_mods1'

	endif

	if seek(mr_mods1.modid, 'mr_modids', 'modid') = .t. and mr_modids.isclient = .t.

		replace mr_mods1.env with 'client' in 'mr_mods1'

	endif

endfor

_logwrite('SCAN END')




ENDPROC
PROCEDURE mr_getnewverdata
*!* mr_getnewverdata

Local lnx, loader1

If mr_mods1.aid &gt; 0


_logwrite('GET FILE DATA', mr_mods1.aid)


*!* TRY THE SEARCH 2 TIMES. FIRST USING THE LOADER PARAM, THEN
*!* USING THE SAVED LOADER NAME

m.loader1 = mr_mods1.loader1

Select Top 1 * From mr_fileversions ;
Where mr_fileversions.gverlong &gt;= mr_instances.gverlong1 ;
And mr_fileversions.gverlong &lt;= mr_instances.gverlong2 ;
And mr_fileversions.aid = mr_mods1.aid ;
And mr_fileversions.loader == m.loader1 ;
And mr_fileversions.fid &gt;= mr_mods1.fid1 ;
Order By mr_fileversions.gverlong Desc, mr_fileversions.fid Desc ;
Into Cursor 'sqlresult'

If Reccount('sqlresult') = 0 And Not Thisform.mr_loader == m.loader1 Then

m.loader1 = Thisform.mr_loader

Select Top 1 * From mr_fileversions ;
Where mr_fileversions.gverlong &gt;= mr_instances.gverlong1 ;
And mr_fileversions.gverlong &lt;= mr_instances.gverlong2 ;
And mr_fileversions.aid = mr_mods1.aid ;
And mr_fileversions.loader == m.loader1 ;
And mr_fileversions.fid &gt;= mr_mods1.fid1 ;
Order By mr_fileversions.gverlong Desc, mr_fileversions.fid Desc ;
Into Cursor 'sqlresult'

Endif

If Reccount('sqlresult') = 0

Select Top 1 * From mr_fileversions ;
Where mr_fileversions.gverlong &gt;= mr_instances.gverlong1 ;
And mr_fileversions.gverlong &lt;= mr_instances.gverlong2 ;
And mr_fileversions.aid = mr_mods1.aid ;
And mr_fileversions.fid &gt;= mr_mods1.fid1 ;
Order By mr_fileversions.gverlong Desc, mr_fileversions.fid Desc ;
Into Cursor 'sqlresult'

Endif

If Reccount('sqlresult') = 1 Then

= Seek(sqlresult.fid, 'mr_files', 'fid')

Replace mr_mods1.fid2 With mr_files.fid In 'mr_mods1'
Replace mr_mods1.filedate2 With mr_files.filedate In 'mr_mods1'
Replace mr_mods1.filelen2 With mr_files.filelen In 'mr_mods1'
Replace mr_mods1.filename2 With mr_files.filename In 'mr_mods1'
Replace mr_mods1.hash2 With mr_files.hash In 'mr_mods1'
Replace mr_mods1.rtypename2 With mr_files.rtypename In 'mr_mods1'
Replace mr_mods1.gver2 With sqlresult.gver In 'mr_mods1'
Replace mr_mods1.loader2 With mr_files.foldername In 'mr_mods1'

If mr_mods1.fid1 # mr_mods1.fid2

Replace mr_mods1.hasupd With .T. In 'mr_mods1'

Else

Replace mr_mods1.hasupd With .F. In 'mr_mods1'

Endif

Endif

Use In 'sqlresult'

Endif
ENDPROC
PROCEDURE mr_getnewverdatascan
*!* mr_getnewverdatascan

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid

DoEvents

Thisform.mr_getnewverdata()

Endscan


ENDPROC
PROCEDURE mr_modupdate
*!* mr_modupdate

mr_modupdate(mr_mods1.rguid)


ENDPROC
PROCEDURE mr_modupdatescan
*!* mr_modupdatescan

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid

DoEvents

Thisform.mr_modupdate()

Endscan
ENDPROC
PROCEDURE mr_refreshcurse
*!* refreshcurse

Lparameters phashes

Local ofp As 'fp' Of 'mr_vcl'
Local aid, iguid, lnx, lnz, ofile

m.ofp = Newobject('fp', 'mr_vcl')

m.ofp.fphashes = m.phashes

_logwrite('GET CURSE DATA')

m.ofp.fppost()

If m.ofp.fpresponse = 200 And Vartype(m.ofp.fpojson.exactmatches[1]) = 'O'

For m.lnx = 1 To Alen(m.ofp.fpojson.exactmatches)

m.aid = m.ofp.fpojson.exactmatches[m.lnx].Id

mr_addonupdate(m.aid)

Endfor


*!* ADD DEPENDENCIES

For m.lnx = 1 To Alen(m.ofp.fpojson.exactmatches)

m.ofile = m.ofp.fpojson.exactmatches[m.lnx].File

If Vartype(m.ofile.dependencies[1]) = 'O'

For m.lnz = 1 To Alen(m.ofile.dependencies)

mr_dependencyupdate(m.ofile.dependencies[m.lnz])

Endfor

Endif

Endfor

Endif


ENDPROC
PROCEDURE mr_refreshcursescan
*!* mr_refreshcursescan

m.hashes = ''

Select 'mr_mods1'

Scan For mr_mods1.iguid == Thisform.mr_iguid

m.hashes = m.hashes + Transform(mr_mods1.hash1) + ','

Endscan

Thisform.mr_refreshcurse(m.hashes)
ENDPROC
PROCEDURE mr_runinstance
*!* mr_runinstance

Local cinst, cmmc, lnx

m.cmmc = ''

For m.lnx = 1 To Getwordcount(mr_instances.ifolder, '\')

m.cmmc = m.cmmc + Getwordnum(mr_instances.ifolder, m.lnx, '\') + '\'

If _file(m.cmmc + 'multimc.exe')

m.cmmc = m.cmmc + 'multimc.exe'

Exit

Endif

Endfor


*!* GET INSTANCE FOLDER NAME

m.cinst = ''

For m.lnx = 1 To Getwordcount(mr_instances.ifolder, '\')

m.cinst = m.cinst + Getwordnum(mr_instances.ifolder, m.lnx, '\') + '\'

If _file(m.cinst + 'mmc-pack.json')

m.cinst = ' -l "' +  Getwordnum(mr_instances.ifolder, m.lnx, '\') + '"'

Exit

Endif

Endfor

?m.cmmc, m.cinst

mr_createprocess(m.cmmc, m.cinst)


ENDPROC
PROCEDURE mr_setinstance
*!* mr_setinstance

Lparameters piguid

Thisform.mr_iguid = m.piguid

If m.piguid = '00000000' And Reccount('mr_instances') &gt; 0 Then

Go Top In 'mr_instances'

Thisform.mr_iguid = mr_instances.iguid

Endif

If Seek(Thisform.mr_iguid, 'mr_instances', 'iguid') = .T.

Set Filter To mr_mods.iguid == Thisform.mr_iguid In 'mr_mods'

_inisetvalue('MR_INSTANCES_IGUID', mr_instances.iguid)

If Empty(mr_instances.iname) Then

Thisform.Caption = 'MODS - ' + _shortenpath(mr_instances.iguid, 240)

Else

Thisform.Caption = 'MODS - ' + _shortenpath(mr_instances.iname, 240)

Endif


Else

Thisform.SetAll('ENABLED', .F.)

Thisform.tbinstances.Enabled = .T.

Thisform.Caption = 'MODS - NO INSTANCE SELECTED'

Set Filter To mr_mods.iguid == '99999999' In 'mr_mods'

Endif

Go Top In 'mr_mods'

Thisform.updateui()

Thisform.Refresh()
ENDPROC
PROCEDURE updateui
*!* updateui

Local icaption, sep

=SEEK(mr_mods.aid, 'mr_addons', 'aid')

Thisform.imgavatar.PictureVal = mr_addons.avatar

m.sep = Space(3)

m.icaption = ' ' + ;
'GUID: ' + mr_instances.iguid + m.sep + ;
'NAME: ' + mr_instances.iname + m.sep + ;
'VERSION ' + mr_instances.iminecraft + m.sep + ;
'LOADER: ' + mr_instances.iloader + m.sep + ;
'MINVER: ' + mr_instances.gver1 + m.sep + ;
'MAXVER: ' + mr_instances.gver2 + m.sep + ;
'PATH: '

m.icaption = m.icaption + _shortenpath(mr_instances.ifolder, 255 - Len(m.icaption))

Thisform.lblinstance.Caption = m.icaption






ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3>gridrowcolor
mr_loader
mr_iguid
*mr_refreshcurse 
*mr_getfolderdatascan 
*mr_getcursedatascan 
*mr_getnewverdatascan 
*mr_getnewverdata 
*mr_getcursedata 
*mr_setinstance 
*mr_refreshcursescan 
*mr_modupdate 
*mr_modupdatescan 
*mr_runinstance 
*mr_enableall 
*mr_disableall 
</reserved3>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1322338953</timestamp>
		<class>_editbox</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>editbox</baseclass>
		<objname>edtlog</objname>
		<parent>mr_mods</parent>
		<properties>FontName = "Consolas"
FontSize = 8
Anchor = 14
Height = 144
Left = 12
ReadOnly = .T.
TabIndex = 9
Top = 324
Width = 780
ZOrderSet = 0
Value = 
IntegralHeight = .F.
islog = .T.
Name = "edtlog"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5H4</uniqueid>
		<timestamp>1327072887</timestamp>
		<class>_gridview</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>grid</baseclass>
		<objname>gridmain</objname>
		<parent>mr_mods</parent>
		<properties>Anchor = 15
Height = 276
HighlightRow = .T.
Left = 12
RecordSource = "mr_mods"
Top = 36
Width = 936
HighlightStyle = 0
_gridcontextmenulang = en
Name = "gridmain"
</properties>
		<protected/>
		<methods>PROCEDURE AfterRowColChange
Lparameters nColIndex

this.sethighlightbackcolor()

Thisform.updateui()
ENDPROC
PROCEDURE DblClick

Replace mr_mods.upd With Not mr_mods.upd In 'mr_mods'
ENDPROC
PROCEDURE getdynamicbackcolor
Lparameters poColum As Column

*!* http://materialuicolors.co/?utm_source=launchers

Local lnDynamicBackColor

Do Case

Case  mr_mods.fid1 # 0 And mr_mods.fid1 # mr_mods.fid2


m.lnDynamicBackColor = Rgb(0xFF, 0xF9, 0xC4)

Case mr_mods.fid1 = 0

m.lnDynamicBackColor = Rgb(0xFF, 0xCD, 0xD2)


Otherwise

m.lnDynamicBackColor = This.ColumnBackColor


Endcase

Return m.lnDynamicBackColor




ENDPROC
PROCEDURE getdynamicforecolor
*!* GetDynamicForeColor

Lparameters poColum As Column

Local lnDynamicForeColor

Do Case

Case Justext(mr_mods.filename1) = 'disabled'

m.lnDynamicForeColor = Rgb(128, 128, 128)

Case _RgbToGray(This.GetDynamicBackColor()) &gt; 186

m.lnDynamicForeColor = This.ForeColor

Otherwise

m.lnDynamicForeColor = This.ColumnBackColor

Endcase

Return m.lnDynamicForeColor



ENDPROC
PROCEDURE opencontextmenu
This.ContextMenu.Clear()

This.ContextMenu.Add('MAIN')

mr_geturlproject(mr_mods.aid)

This.ContextMenu.Add('MAIN', 'GOOGLEIT', 'Google')
This.ContextMenu.Add('MAIN', 'COPYFILENAME', 'Copy File Name')

If mr_mods.aid &gt; 0

This.ContextMenu.Add('MAIN', Sys(2015), '-')
This.ContextMenu.Add('MAIN', 'CURSE_OVERVIEW', 'Curse Overview')
This.ContextMenu.Add('MAIN', 'CURSE_FILES', 'Curse Files')

Endif

*!*	Endif

m.choice = This.ContextMenu.Show()

Do Case

Case m.choice = 'GOOGLEIT'

mr_shellexecute('https://www.google.com/search?q="' + mr_mods.filename1 + '"')

Case m.choice = 'COPYFILENAME'

_Cliptext = mr_mods.filename1

Endcase


ENDPROC
PROCEDURE sethighlightbackcolor

*!* SET COLOR OF HIGHLIGHTED ROW IN GRID

Do Case

Case  mr_mods.fid1 # 0 And mr_mods.fid2 # 0 And mr_mods.fid1 # mr_mods.fid2

This.HighlightBackColor = Rgb(255, 241, 118)

Case mr_mods.fid1 = 0

This.HighlightBackColor = Rgb(229, 115, 115)

Otherwise

This.HighlightBackColor = This.gethighlightbackcolor()

Endcase

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1322338953</timestamp>
		<class>_label</class>
		<classloc>..\..\shared\_base.vcx</classloc>
		<baseclass>label</baseclass>
		<objname>lblinstance</objname>
		<parent>mr_mods</parent>
		<properties>FontSize = 8
Anchor = 14
Caption = ""
Height = 15
Left = 12
Top = 479
Width = 936
autowidth = .F.
Name = "lblinstance"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5JA0ZQ8X7</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>_tbcommand4</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 576
Height = 28
Width = 48
Picture = ..\res\1x\outline_web_asset_black_18dp.png
Caption = "JIJ"
ToolTipText = "OPEN JAR IN JAR TAB"
ZOrderSet = 4
tbalign = 2
Name = "_tbcommand4"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_inisetvalue('MR_INSTANCES_IGUID', Thisform.mr_iguid)

Do Form mr_mods_jij
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tblinkfile2</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 888
Height = 28
Width = 36
Picture = ..\res\1x\outline_open_in_new_black_18dp.png
Caption = "FILE2"
ToolTipText = "OPEN PROJECT FILE URL IN WEB BROWSER"
ZOrderSet = 4
tbalign = 2
tbmarginv = 4
Name = "tblinkfile2"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If mr_mods.aid &gt; 0

Do Case

Case mr_mods.fid2 &gt; 0

mr_shellexecute(mr_geturlproject_files(mr_mods.aid, mr_mods.fid2))

Otherwise

mr_shellexecute(mr_geturlproject_files(mr_mods.aid))

Endcase

Endif




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I50Z6RB2</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbfolder</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 768
Height = 28
Width = 48
Picture = ..\res\1x\outline_folder_black_18dp.png
Caption = "FOLDER"
ToolTipText = "OPEN MODS FOLDER"
ZOrderSet = 4
tbalign = 2
tbmarginv = 4
Name = "tbfolder"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local ppidl, pszName, rgfInOut

m.pszName = Strconv(Addbs(mr_instances.ifolder) + mr_mods.filename1 + Chr(0), 5)

m.ppidl = 0

If _apiSHILCreateFromPath(m.pszName, @m.ppidl, 0) = 0

_apiSHOpenFolderAndSelectItems(m.ppidl, 0, 0, 0)

_apiCoTaskMemFree(m.ppidl)

Endif



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I61EBSMR</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbrefresh</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 216
Height = 28
Width = 36
Picture = ..\res\1x\outline_refresh_black_18dp.png
Caption = ""
ToolTipText = "REFRESH CURSE DATA FOR SELECTED MOD"
ZOrderSet = 4
Name = "tbrefresh"
</properties>
		<protected/>
		<methods>PROCEDURE Click

Thisform.mr_refreshcurse(Transform(mr_mods.hash1))

= Seek(mr_mods.rguid, 'mr_mods1', 'rguid')

Thisform.mr_getcursedata()

Thisform.mr_getnewverdata()

Go Recno('mr_mods') In 'mr_mods'

Thisform.updateui()

Thisform.Refresh()




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I70HWZP6</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbscan</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 96
Height = 28
Width = 48
Picture = ..\res\1x\outline_autorenew_black_18dp.png
Caption = "SCAN"
ToolTipText = "SCAN MODS FOLDER"
ZOrderSet = 4
Name = "tbscan"
</properties>
		<protected/>
		<methods>PROCEDURE Click

If Empty(mr_instances.gverlong1) Or Empty(mr_instances.gverlong2)

Messagebox('SELECT MIN AND MAX MINECRAFT VERSIONS WITH "MINVER" AND "MAXVER" BUTTONS', 0 + 64, 'MODROBOT')

Return

Endif

_logwrite('PROCESS START')

Thisform.mr_getfolderdatascan()

Thisform.mr_getcursedatascan()

Thisform.mr_getnewverdatascan()

_logwrite('PROCESS END')

Thisform.updateui()

Thisform.Refresh()



ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I70J9KXM</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbrefreshall</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 144
Height = 28
Width = 72
Picture = ..\res\1x\outline_refresh_black_18dp.png
Caption = "CURSE"
ToolTipText = "REFRESH CURSE DATA FOR ALL MODS"
ZOrderSet = 4
Name = "tbrefreshall"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_logwrite('PROCESS START')

Thisform.mr_refreshcursescan()

Thisform.mr_getcursedatascan()

Thisform.mr_getnewverdatascan()

_logwrite('PROCESS END')

Thisform.updateui()

Thisform.Refresh()





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I70K005Y</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tblinkfile1</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 852
Height = 28
Width = 36
Picture = ..\res\1x\outline_open_in_new_black_18dp.png
Caption = "FILE1"
ToolTipText = "OPEN PROJECT FILE URL IN WEB BROWSER"
ZOrderSet = 4
tbalign = 2
tbmarginv = 4
Name = "tblinkfile1"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If mr_mods.aid &gt; 0

Do Case

Case mr_mods.fid1 &gt; 0

mr_shellexecute(mr_geturlproject_files(mr_mods.aid, mr_mods.fid1))

Otherwise

mr_shellexecute(mr_geturlproject_files(mr_mods.aid))

Endcase

Endif




ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I714UVYU</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbinstances</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 12
Height = 28
Width = 36
Picture = ..\res\1x\outline_expand_more_black_18dp.png
Caption = "INSTANCES"
ToolTipText = "OPEN INSTANCES MENU"
PicturePosition = 4
ZOrderSet = 4
tbmarginv = 4
Name = "tbinstances"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local nselect, result

m.nselect = Select()

Select 'mr_instances1'

Scan

This.tbmenuitemadd(Recno('mr_instances1'), 0, 0, 0, 0, mr_instances1.iname + ' - ' + mr_instances1.ifolder)

Endscan

_restorearea(m.nselect)

m.result = This.tbmenushow()

If m.result &gt; 0 Then

Go m.result In 'mr_instances1'

Thisform.mr_setinstance(mr_instances1.iguid)

Endif





ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbdependencies</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 528
Height = 28
Width = 48
Picture = ..\res\1x\outline_web_asset_black_18dp.png
Caption = "DEPS"
ToolTipText = "OPEN DEPENDENCIES TAB"
ZOrderSet = 4
tbalign = 2
Name = "tbdependencies"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_inisetvalue('MR_INSTANCES_IGUID', Thisform.mr_iguid)

Do Form mr_mods_dependencies
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IA0IPOO1</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tblinkhome</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 816
Height = 28
Width = 36
Picture = ..\res\1x\outline_open_in_new_black_18dp.png
Caption = "OVERVIEW"
ToolTipText = "OPEN PROJECT OVERVIEW URL IN WEB BROWSER"
ZOrderSet = 4
tbalign = 2
tbmarginv = 4
Name = "tblinkhome"
</properties>
		<protected/>
		<methods>PROCEDURE Click
If mr_mods.aid &gt; 0

mr_shellexecute(mr_geturlproject(mr_mods.aid))

Else

If Not Empty(mr_mods.modid) And Seek(mr_mods.modid, 'mr_modids', 'modid') = .T.

mr_shellexecute(mr_modids.url)

Endif

Endif


ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1327454722</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbprojects</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 672
Height = 28
Width = 48
Picture = ..\res\1x\outline_web_asset_black_18dp.png
Caption = "PROJECT"
ToolTipText = "VIEW PROJECT IN NEW PROJECTS TAB"
ZOrderSet = 4
tbalign = 2
Name = "tbprojects"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_inisetvalue('MR_ADDONS_AID', mr_mods.aid)

Do Form mr_addons
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I50Z6RB2</uniqueid>
		<timestamp>1327454722</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbfiles</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 720
Height = 28
Width = 48
Picture = ..\res\1x\outline_web_asset_black_18dp.png
Caption = "FILE"
ToolTipText = "VIEW FILE IN NEW FILES TAB"
ZOrderSet = 4
tbalign = 2
Name = "tbfiles"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_inisetvalue('MR_FILES_FID', mr_mods.fid1)

Do Form mr_files
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I50EU5DF</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tblog</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 624
Height = 28
Width = 48
Picture = ..\res\1x\outline_web_asset_black_18dp.png
Caption = "LOG"
ToolTipText = "OPEN CHANGE LOG TAB"
ZOrderSet = 4
tbalign = 2
Name = "tblog"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Do Form mr_log
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5H4</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbversions</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 252
Height = 28
Width = 24
Picture = ..\res\1x\outline_list_alt_black_18dp.png
Caption = ""
ToolTipText = "SELECT MOD FILE VERSION FOR UPDATE"
ZOrderSet = 4
tbmarginv = 4
Name = "tbversions"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local fid

m.fid = 0

Do Case

Case mr_mods.fid2 &gt; 0

Do Form mr_mods_pickfile With mr_mods.fid2 To m.fid

Case mr_mods.fid1 &gt; 0

Do Form mr_mods_pickfile With mr_mods.fid1 To m.fid

Endcase

If m.fid &gt; 0 Then

= Seek(m.fid, 'mr_files', 'fid')

Replace mr_mods.fid2 With mr_files.fid In 'mr_mods'
Replace mr_mods.filedate2 With mr_files.filedate In 'mr_mods'
Replace mr_mods.filelen2 With mr_files.filelen In 'mr_mods'
Replace mr_mods.filename2 With mr_files.filename In 'mr_mods'
Replace mr_mods.hash2 With mr_files.hash In 'mr_mods'
Replace mr_mods.rtypename2 With mr_files.rtypename In 'mr_mods'
Replace mr_mods.gver2 With mr_files.gver In 'mr_mods'
Replace mr_mods.loader2 With mr_files.foldername In 'mr_mods'

If mr_mods.fid1 # mr_mods.fid2

Replace mr_mods.hasupd With .T. In 'mr_mods1'

Else

Replace mr_mods.hasupd With .F. In 'mr_mods1'

Endif

Thisform.updateui()

Thisform.gridmain.Refresh()

Endif
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbupdateall</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 276
Height = 28
Width = 60
Picture = ..\res\1x\outline_cloud_download_black_18dp.png
Caption = "DOWNLOAD"
ToolTipText = "UPDATE ALL MODS (UPD COLUMN CHECKED)"
ZOrderSet = 4
tbmarginv = 4
Name = "tbupdateall"
</properties>
		<protected/>
		<methods>PROCEDURE Click

_logwrite('PROCESS START')

Thisform.mr_modupdatescan()

_logwrite('PROCESS END')

Thisform.updateui()

Thisform.Refresh()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5IE0KY8D3</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbupdate</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 336
Height = 28
Width = 24
Picture = ..\res\1x\outline_cloud_download_black_18dp.png
Caption = ""
ToolTipText = "UPDATE SELECTED MOD"
ZOrderSet = 4
tbmarginv = 4
Name = "tbupdate"
</properties>
		<protected/>
		<methods>PROCEDURE Click
_logwrite('PROCESS START')

= Seek(mr_mods.rguid, 'mr_mods1', 'rguid')

Thisform.mr_modupdate()

Thisform.updateui()

_logwrite('PROCESS END')

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1327455941</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbtoggleenabled</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 360
Height = 28
Width = 48
Picture = ..\res\1x\outline_toggle_off_black_18dp.png
Caption = "E/D"
ToolTipText = 'ENABLE/DISABLE MOD. APPENDS ".disabled" TO FILE NAME'
ZOrderSet = 4
tbmarginv = 4
Name = "tbtoggleenabled"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local filenamen, filenameo, result

m.result = 0

Do Case

Case Upper(Justext(mr_mods.filename1)) = 'JAR'

m.filenameo = mr_mods.filename1

m.filenamen = mr_mods.filename1 + '.disabled'

m.result = _apimovefile(Addbs(mr_instances.ifolder) + m.filenameo, Addbs(mr_instances.ifolder) + m.filenamen)

If m.result # 0

Append Blank In mr_log

Replace mr_log.iguid With mr_mods.iguid In 'mr_log'
Replace mr_log.ifolder With mr_instances.ifolder In 'mr_log'
Replace mr_log.fid1 With mr_mods.fid1 In 'mr_log'
Replace mr_log.filename1 With m.filenameo In 'mr_log'
Replace mr_log.filename2 With m.filenamen In 'mr_log'
Replace mr_log.hash1 With mr_mods.hash1 In 'mr_log'
Replace mr_log.ldesc With 'DISABLED' In 'mr_log'
Replace mr_log.ldatetime With DATETIME() In 'mr_log'

Replace mr_mods.filename1 With m.filenamen In 'mr_mods'
Replace mr_mods.dis With .T. In 'mr_mods'

Endif

Case Upper(Justext(mr_mods.filename1)) = 'DISABLED'

m.filenameo = mr_mods.filename1

m.filenamen = Juststem(Juststem(mr_mods.filename1)) + '.jar'

m.result = _apimovefile(Addbs(mr_instances.ifolder) + m.filenameo, Addbs(mr_instances.ifolder) + m.filenamen)

If m.result # 0

Append Blank In mr_log

Replace mr_log.iguid With mr_mods.iguid In 'mr_log'
Replace mr_log.ifolder With mr_instances.ifolder In 'mr_log'
Replace mr_log.fid1 With mr_mods.fid1 In 'mr_log'
Replace mr_log.filename1 With m.filenameo In 'mr_log'
Replace mr_log.filename2 With m.filenamen In 'mr_log'
Replace mr_log.hash1 With mr_mods.hash1 In 'mr_log'
Replace mr_log.ldesc With 'ENABLED' In 'mr_log'
Replace mr_log.ldatetime With DATETIME() In 'mr_log'

Replace mr_mods.filename1 With m.filenamen In 'mr_mods'
Replace mr_mods.dis With .F. In 'mr_mods'

Endif

Endcase

Thisform.gridmain.Refresh()







ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>_tbcommand3</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 480
Height = 28
Width = 48
Picture = ..\res\1x\outline_play_arrow_black_18dp.png
Caption = "RUN"
ToolTipText = "RUN MULTIMC INSTANCE"
ZOrderSet = 4
tbmarginv = 4
tbalign = 2
Name = "_tbcommand3"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Thisform.mr_runinstance()

ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbmenu</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 924
Height = 28
Width = 28
FontSize = 8
Picture = ..\res\3bars.png
Caption = ""
TabIndex = 7
ToolTipText = "MENU"
ZOrderSet = 21
tbalign = 2
tbautowidth = .F.
tbpictureautosize = .F.
tbmenuoffseth = 6
tbautofontsize = .F.
tbmarginv = 4
Name = "tbmenu"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local result, txt

This.tbmenuitemadd(1, 0, 0, 0, 0, 'Enable All')
This.tbmenuitemadd(2, 0, 0, 0, 0, 'Disable All')
This.tbmenuitemadd(3, 0, 1, 0, 0, '-')

This.tbmenuitemadd(4, 0, 0, 0, 0, 'Generate mod list for GitHub')
This.tbmenuitemadd(5, 0, 0, 0, 0, 'Generate curl mod download list')

m.result = This.tbmenushow()

Do Case

Case m.result = 1

Thisform.mr_enableall()

Case m.result = 2

Thisform.mr_disableall()

Case m.result = 4

mr_genmodlist_markdown(Thisform.mr_iguid)

Case m.result = 5

mr_genmodlist_download(Thisform.mr_iguid)

Endcase











ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5I50Z6RB2</uniqueid>
		<timestamp>1322412355</timestamp>
		<class>image</class>
		<classloc/>
		<baseclass>image</baseclass>
		<objname>imgavatar</objname>
		<parent>mr_mods</parent>
		<properties>Anchor = 12
Picture = ..\res\noimage1.png
Stretch = 2
Height = 144
Left = 804
Top = 324
Width = 144
Name = "imgavatar"
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5HZ0HR5GA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbmaxver</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 72
Height = 28
Width = 24
Picture = ..\res\1x\outline_top_black_18dp.png
Caption = ""
ToolTipText = "SET THE MAX MINECRAFT VERSION OF THE INSTANCE WHEN SEARCHING FOR MOD UPDATES"
Name = "tbmaxver"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local nselect, result

m.nselect = Select()

Select 'mr_enum_gameversion'

Scan

This.tbmenuitemadd(Recno('mr_enum_gameversion'), 0, 0, 0, 0, Alltrim(mr_enum_gameversion.gver))

Endscan

_restorearea(m.nselect)

m.result = This.tbmenushow()

If m.result &gt; 0 Then

Go m.result In 'mr_enum_gameversion'

Replace mr_instances.gver2 With mr_enum_gameversion.gver In 'mr_instances'
Replace mr_instances.gverlong2 With mr_enum_gameversion.gverlong In 'mr_instances'

Endif

Thisform.updateui()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>WINDOWS</platform>
		<uniqueid>_5ID0R56FA</uniqueid>
		<timestamp>1326978033</timestamp>
		<class>_tbcommand</class>
		<classloc>..\..\tbz\_tbz.vcx</classloc>
		<baseclass>commandbutton</baseclass>
		<objname>tbminver</objname>
		<parent>mr_mods</parent>
		<properties>Top = 0
Left = 48
Height = 28
Width = 24
Picture = ..\res\1x\outline_bottom_black_18dp.png
Caption = ""
ToolTipText = "SET THE MIN MINECRAFT VERSION OF THE INSTANCE WHEN SEARCHING FOR MOD UPDATES"
Name = "tbminver"
</properties>
		<protected/>
		<methods>PROCEDURE Click
Local nselect, result

m.nselect = Select()

Select 'mr_enum_gameversion'

Scan

This.tbmenuitemadd(Recno('mr_enum_gameversion'), 0, 0, 0, 0, Alltrim(mr_enum_gameversion.gver))

Endscan

_restorearea(m.nselect)

m.result = This.tbmenushow()

If m.result &gt; 0 Then

Go m.result In 'mr_enum_gameversion'

Replace mr_instances.gver1 With mr_enum_gameversion.gver In 'mr_instances'
Replace mr_instances.gverlong1 With mr_enum_gameversion.gverlong In 'mr_instances'

Endif

Thisform.updateui()
ENDPROC
</methods>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
	<record>
		<platform>COMMENT</platform>
		<uniqueid>RESERVED</uniqueid>
		<timestamp>0</timestamp>
		<class/>
		<classloc/>
		<baseclass/>
		<objname/>
		<parent/>
		<properties>Tahoma, 0, 8, 5, 13, 11, 27, 2, 0
Consolas, 0, 8, 6, 13, 10, 12, 3, 0
Arial, 0, 9, 5, 15, 12, 32, 3, 0
Segoe UI, 0, 8, 6, 13, 11, 28, 2, 0
</properties>
		<protected/>
		<methods/>
		<objcode/>
		<ole/>
		<ole2/>
		<reserved1/>
		<reserved2/>
		<reserved3/>
		<reserved4/>
		<reserved5/>
		<reserved6/>
		<reserved7/>
		<reserved8/>
		<user/>
	</record>
</VFPData>
